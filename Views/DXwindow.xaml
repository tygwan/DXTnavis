<Window x:Class="DXTnavis.Views.DXwindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:DXTnavis.Views"
        xmlns:converters="clr-namespace:DXTnavis.Converters"
        mc:Ignorable="d"
        Title="DXTnavis - Navisworks Property Viewer" Height="850" Width="1500"
        WindowStartupLocation="CenterScreen"
        Background="#F5F5F5">

    <Window.Resources>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>

        <!-- ê¸°ë³¸ ë²„íŠ¼ ìŠ¤íƒ€ì¼ -->
        <Style x:Key="ActionButton" TargetType="Button">
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="Margin" Value="3"/>
            <Setter Property="Background" Value="#0078D4"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#005A9E"/>
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Background" Value="#CCCCCC"/>
                    <Setter Property="Cursor" Value="Arrow"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- ì´ˆë¡ìƒ‰ ë²„íŠ¼ ìŠ¤íƒ€ì¼ -->
        <Style x:Key="SuccessButton" TargetType="Button" BasedOn="{StaticResource ActionButton}">
            <Setter Property="Background" Value="#28A745"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#218838"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- í•„í„° ë²„íŠ¼ ìŠ¤íƒ€ì¼ -->
        <Style x:Key="FilterButton" TargetType="Button" BasedOn="{StaticResource ActionButton}">
            <Setter Property="Background" Value="#6C757D"/>
            <Setter Property="Padding" Value="8,6"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#5A6268"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- DataGrid í—¤ë” ìŠ¤íƒ€ì¼ -->
        <Style x:Key="DataGridHeaderStyle" TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#0078D4"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
        </Style>

        <!-- ì„¹ì…˜ íƒ€ì´í‹€ ìŠ¤íƒ€ì¼ -->
        <Style x:Key="SectionTitle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="Margin" Value="0,0,0,8"/>
        </Style>

        <!-- ë ˆì´ë¸” ìŠ¤íƒ€ì¼ -->
        <Style x:Key="LabelStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Foreground" Value="#666666"/>
            <Setter Property="Margin" Value="0,0,0,4"/>
        </Style>
    </Window.Resources>

    <Grid Margin="10">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="280"/>
            <ColumnDefinition Width="5"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="5"/>
            <ColumnDefinition Width="350"/>
        </Grid.ColumnDefinitions>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- ì™¼ìª½ íŒ¨ë„: Hierarchy Tree -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <Grid Grid.Column="0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- í—¤ë” -->
            <StackPanel Grid.Row="0" Margin="0,0,0,8">
                <TextBlock Text="Hierarchy Tree" Style="{StaticResource SectionTitle}"/>
                <TextBlock Text="Level ê¸°ë°˜ ê³„ì¸µ êµ¬ì¡°" Style="{StaticResource LabelStyle}"/>

                <!-- í™•ìž¥/ì¶•ì†Œ ì»¨íŠ¸ë¡¤ (P1 Enhanced) -->
                <Border Background="#F0F0F0" Padding="6" Margin="0,6,0,0" CornerRadius="3">
                    <StackPanel>
                        <!-- ë ˆë²¨ë³„ ê°œë³„ ë²„íŠ¼ (P1 Feature) -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                            <TextBlock Text="Level:" VerticalAlignment="Center" Margin="0,0,6,0" FontSize="11" FontWeight="SemiBold"/>
                            <Button Content="L0" ToolTip="L0ê¹Œì§€ í™•ìž¥ (Root)"
                                    Width="28" Height="22" Margin="1,0" FontSize="9" FontWeight="Bold"
                                    Background="#0078D4" Foreground="White" BorderThickness="0"
                                    Command="{Binding ExpandLevelCommand}" CommandParameter="0"/>
                            <Button Content="L1" ToolTip="L1ê¹Œì§€ í™•ìž¥"
                                    Width="28" Height="22" Margin="1,0" FontSize="9" FontWeight="Bold"
                                    Background="#28A745" Foreground="White" BorderThickness="0"
                                    Command="{Binding ExpandLevelCommand}" CommandParameter="1"/>
                            <Button Content="L2" ToolTip="L2ê¹Œì§€ í™•ìž¥"
                                    Width="28" Height="22" Margin="1,0" FontSize="9" FontWeight="Bold"
                                    Background="#FFC107" Foreground="#333" BorderThickness="0"
                                    Command="{Binding ExpandLevelCommand}" CommandParameter="2"/>
                            <Button Content="L3" ToolTip="L3ê¹Œì§€ í™•ìž¥"
                                    Width="28" Height="22" Margin="1,0" FontSize="9" FontWeight="Bold"
                                    Background="#DC3545" Foreground="White" BorderThickness="0"
                                    Command="{Binding ExpandLevelCommand}" CommandParameter="3"/>
                            <Button Content="L4" ToolTip="L4ê¹Œì§€ í™•ìž¥"
                                    Width="28" Height="22" Margin="1,0" FontSize="9" FontWeight="Bold"
                                    Background="#6F42C1" Foreground="White" BorderThickness="0"
                                    Command="{Binding ExpandLevelCommand}" CommandParameter="4"/>
                            <Button Content="L5" ToolTip="L5ê¹Œì§€ í™•ìž¥"
                                    Width="28" Height="22" Margin="1,0" FontSize="9" FontWeight="Bold"
                                    Background="#20C997" Foreground="White" BorderThickness="0"
                                    Command="{Binding ExpandLevelCommand}" CommandParameter="5"/>
                        </StackPanel>

                        <!-- ê¸°ì¡´ ì»¨íŠ¸ë¡¤ (ComboBox + ì „ì²´ í™•ìž¥/ì¶•ì†Œ) -->
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <!-- ë ˆë²¨ ì„ íƒ (ê³ ê¸‰) -->
                            <StackPanel Grid.Column="0" Orientation="Horizontal">
                                <TextBlock Text="Custom:" VerticalAlignment="Center" Margin="0,0,4,0" FontSize="10" Foreground="#666"/>
                                <ComboBox x:Name="ExpandLevelCombo"
                                          ItemsSource="{Binding AvailableExpandLevels}"
                                          SelectedItem="{Binding SelectedExpandLevel}"
                                          Width="45" Height="22" FontSize="10"/>
                                <Button Content="â–¶" ToolTip="ì„ íƒ ë ˆë²¨ê¹Œì§€ í™•ìž¥"
                                        Width="22" Height="22" Margin="2,0,0,0" FontSize="10"
                                        Command="{Binding ExpandToLevelCommand}"/>
                            </StackPanel>

                            <!-- ì „ì²´ í™•ìž¥/ì¶•ì†Œ ë²„íŠ¼ -->
                            <StackPanel Grid.Column="1" Orientation="Horizontal">
                                <Button Content="âŠ•" ToolTip="ì „ì²´ í™•ìž¥"
                                        Width="24" Height="22" Margin="4,0,2,0" FontSize="11"
                                        Command="{Binding ExpandAllCommand}"/>
                                <Button Content="âŠ–" ToolTip="ì „ì²´ ì¶•ì†Œ"
                                        Width="24" Height="22" Margin="2,0,0,0" FontSize="11"
                                        Command="{Binding CollapseAllCommand}"/>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </Border>
            </StackPanel>

            <!-- TreeView -->
            <Border Grid.Row="1" BorderBrush="#DDDDDD" BorderThickness="1" Background="White">
                <TreeView x:Name="HierarchyTree"
                          ItemsSource="{Binding ObjectHierarchyRoot}"
                          BorderThickness="0"
                          VirtualizingStackPanel.IsVirtualizing="True"
                          VirtualizingStackPanel.VirtualizationMode="Recycling">

                    <!-- TreeViewItem ìŠ¤íƒ€ì¼: IsExpanded ë°”ì¸ë”© -->
                    <TreeView.ItemContainerStyle>
                        <Style TargetType="TreeViewItem">
                            <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}"/>
                            <Setter Property="IsSelected" Value="{Binding IsSelected, Mode=TwoWay}"/>
                            <Setter Property="Padding" Value="2"/>
                        </Style>
                    </TreeView.ItemContainerStyle>

                    <TreeView.ItemTemplate>
                        <HierarchicalDataTemplate ItemsSource="{Binding Children}">
                            <StackPanel Orientation="Horizontal" Margin="2">
                                <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                          VerticalAlignment="Center" Margin="0,0,6,0"/>
                                <!-- ë ˆë²¨ í‘œì‹œ ë°°ì§€ -->
                                <Border Background="{Binding LevelColor}" CornerRadius="2" Padding="4,1" Margin="0,0,6,0">
                                    <TextBlock Text="{Binding LevelPrefix}" Foreground="White"
                                               FontFamily="Consolas" FontSize="9" FontWeight="Bold"/>
                                </Border>
                                <!-- ì•„ì´ì½˜: ìžì‹ ìœ ë¬´ì— ë”°ë¼ ë³€ê²½ -->
                                <TextBlock Text="{Binding NodeIcon}" FontSize="12" VerticalAlignment="Center" Margin="0,0,4,0"/>
                                <!-- ì´ë¦„ -->
                                <TextBlock Text="{Binding DisplayName}" VerticalAlignment="Center"/>
                                <!-- ìžì‹ ê°œìˆ˜ í‘œì‹œ -->
                                <TextBlock Text="{Binding ChildCountText}" Foreground="#999999"
                                           FontSize="10" VerticalAlignment="Center" Margin="6,0,0,0"/>
                            </StackPanel>
                        </HierarchicalDataTemplate>
                    </TreeView.ItemTemplate>
                </TreeView>
            </Border>

            <!-- ë²„íŠ¼ -->
            <StackPanel Grid.Row="2" Margin="0,8,0,0">
                <Button Content="ðŸ“‚ Load Hierarchy"
                        Style="{StaticResource ActionButton}"
                        Command="{Binding LoadHierarchyCommand}"/>
            </StackPanel>
        </Grid>

        <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch" Background="#CCCCCC"/>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- ì¤‘ì•™ íŒ¨ë„: Hierarchy Data + í•„í„° -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <Grid Grid.Column="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- í—¤ë” -->
            <StackPanel Grid.Row="0" Margin="0,0,0,8">
                <TextBlock Text="Hierarchy Data" Style="{StaticResource SectionTitle}"/>
                <TextBlock Text="ì†ì„± ë°ì´í„° ë° í•„í„°ë§" Style="{StaticResource LabelStyle}"/>
            </StackPanel>

            <!-- í•„í„° ì˜ì—­ (Phase 12: ì²´í¬ë°•ìŠ¤ ê¸°ë°˜) -->
            <Border Grid.Row="1" Background="#E8F4FD" Padding="10" Margin="0,0,0,8" CornerRadius="4">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Row 0: Level ì²´í¬ë°•ìŠ¤ í•„í„° -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,6">
                        <TextBlock Text="Level:" FontWeight="SemiBold" VerticalAlignment="Center" Width="55"/>
                        <ItemsControl ItemsSource="{Binding LevelFilterOptions}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <CheckBox IsChecked="{Binding IsChecked, Mode=TwoWay}"
                                              Content="{Binding DisplayText}"
                                              IsEnabled="{Binding IsEnabled}"
                                              ToolTip="{Binding ToolTip}"
                                              Margin="0,0,10,0" FontSize="11"/>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>

                    <!-- Row 1: Category ì²´í¬ë°•ìŠ¤ í•„í„° -->
                    <Border Grid.Row="1" Background="#D4EAFC" Padding="4" Margin="0,0,0,6" CornerRadius="2">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Category:" FontWeight="SemiBold" VerticalAlignment="Top" Width="55" Margin="0,2,0,0"/>
                            <ScrollViewer MaxHeight="50" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                                <ItemsControl ItemsSource="{Binding CategoryFilterOptions}">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <WrapPanel/>
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <CheckBox IsChecked="{Binding IsChecked, Mode=TwoWay}"
                                                      Content="{Binding DisplayText}"
                                                      IsEnabled="{Binding IsEnabled}"
                                                      ToolTip="{Binding ToolTip}"
                                                      Margin="0,0,8,2" FontSize="10"/>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </ScrollViewer>
                        </StackPanel>
                    </Border>

                    <!-- Row 2: í…ìŠ¤íŠ¸ í•„í„° + ë²„íŠ¼ -->
                    <Grid Grid.Row="2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- ì†ì„± í•„í„° -->
                        <StackPanel Grid.Column="0" Margin="0,0,8,0">
                            <TextBlock Text="Property Name" Style="{StaticResource LabelStyle}"/>
                            <TextBox Text="{Binding PropertyNameFilter, UpdateSourceTrigger=PropertyChanged}"
                                     Height="26" VerticalContentAlignment="Center"
                                     InputMethod.IsInputMethodEnabled="True"
                                     PreviewKeyDown="TextBox_PreviewKeyDown"
                                     GotFocus="TextBox_GotFocus"/>
                        </StackPanel>

                        <!-- ê°’ í•„í„° -->
                        <StackPanel Grid.Column="1" Margin="0,0,8,0">
                            <TextBlock Text="Property Value" Style="{StaticResource LabelStyle}"/>
                            <TextBox Text="{Binding PropertyValueFilter, UpdateSourceTrigger=PropertyChanged}"
                                     Height="26" VerticalContentAlignment="Center"
                                     InputMethod.IsInputMethodEnabled="True"
                                     PreviewKeyDown="TextBox_PreviewKeyDown"
                                     GotFocus="TextBox_GotFocus"/>
                        </StackPanel>

                        <!-- í•„í„° ë²„íŠ¼ -->
                        <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Bottom">
                            <Button Content="ðŸ” Filter" Style="{StaticResource FilterButton}"
                                    Command="{Binding ApplyFilterCommand}"/>
                            <Button Content="âœ• Clear" Style="{StaticResource FilterButton}"
                                    Command="{Binding ClearFilterCommand}"/>
                        </StackPanel>
                    </Grid>
                </Grid>
            </Border>

            <!-- Object ê²€ìƒ‰ ì˜ì—­ (v0.4.0) -->
            <Border Grid.Row="2" Background="#FFF8E6" Padding="8" Margin="0,0,0,8" CornerRadius="4">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0" Text="ðŸ”Ž Object Search:"
                               VerticalAlignment="Center" FontWeight="SemiBold" Margin="0,0,8,0"/>

                    <TextBox Grid.Column="1"
                             Text="{Binding ObjectSearchQuery, UpdateSourceTrigger=PropertyChanged}"
                             Height="28" Padding="6,4"
                             VerticalContentAlignment="Center"
                             ToolTip="ê°ì²´ ì´ë¦„, ì†ì„±ê°’, SysPathë¡œ ê²€ìƒ‰ (Enterë¡œ ê²€ìƒ‰)"
                             InputMethod.IsInputMethodEnabled="True"
                             PreviewKeyDown="TextBox_PreviewKeyDown"
                             GotFocus="TextBox_GotFocus"/>

                    <StackPanel Grid.Column="2" Orientation="Horizontal" Margin="8,0,0,0">
                        <Button Content="ðŸ” Search"
                                Style="{StaticResource ActionButton}"
                                Command="{Binding SearchObjectCommand}"
                                ToolTip="ìž…ë ¥í•œ í‚¤ì›Œë“œë¡œ ê°ì²´ ê²€ìƒ‰"
                                Width="80"/>
                        <Button Content="âœ• Clear"
                                Style="{StaticResource FilterButton}"
                                Command="{Binding ClearSearchCommand}"
                                ToolTip="ê²€ìƒ‰ ê²°ê³¼ ì´ˆê¸°í™”"
                                Width="60"/>
                        <Button Content="ðŸ” Zoom"
                                Style="{StaticResource ActionButton}"
                                Command="{Binding ZoomToSearchResultCommand}"
                                ToolTip="ê²€ìƒ‰ ê²°ê³¼ ê°ì²´ë¡œ ì¤Œ"
                                Width="70"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Select All & View Mode Toggle (Phase 12: ê·¸ë£¹ ê¸°ë°˜) -->
            <Border Grid.Row="3" Background="#F0F4F8" Padding="8,4" Margin="0,4,0,0" CornerRadius="4">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Phase 12: ê·¸ë£¹ Select All (í•­ìƒ ë¹ ë¦„) -->
                    <StackPanel Grid.Column="0" Orientation="Horizontal">
                        <CheckBox Content="Select All Groups"
                                  IsChecked="{Binding IsGroupSelectAll, Mode=TwoWay}"
                                  VerticalAlignment="Center"
                                  FontWeight="SemiBold"
                                  Foreground="#0078D4"
                                  ToolTip="ì „ì²´ ê·¸ë£¹ ì„ íƒ/í•´ì œ"/>
                        <TextBlock VerticalAlignment="Center" Margin="8,0,0,0">
                            <Run Text="{Binding SelectionSummary, Mode=OneWay}" Foreground="#666666"/>
                        </TextBlock>
                    </StackPanel>

                    <!-- Grouped/Flat View Toggle -->
                    <StackPanel Grid.Column="2" Orientation="Horizontal">
                        <CheckBox Content="Flat View"
                                  IsChecked="{Binding IsGroupedViewEnabled, Mode=TwoWay, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Invert}"
                                  VerticalAlignment="Center"
                                  FontWeight="SemiBold"
                                  ToolTip="í”Œëž« ë·° / ê·¸ë£¹ ë·° ì „í™˜"
                                  Foreground="#6F42C1"
                                  Visibility="Collapsed"/>
                        <TextBlock VerticalAlignment="Center" Foreground="#6F42C1" FontWeight="SemiBold">
                            <Run Text="{Binding FilteredGroupCount, StringFormat='{}{0:N0} groups', Mode=OneWay}"/>
                            <Run Text=" | " Foreground="#999"/>
                            <Run Text="{Binding FilteredPropertyCount, StringFormat='{}{0:N0} props', Mode=OneWay}"/>
                        </TextBlock>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- DataGrid Container (Flat Mode / Grouped Mode ì „í™˜) -->
            <Border Grid.Row="4" BorderBrush="#DDDDDD" BorderThickness="1" Background="White">
                <Grid>
                    <!-- Flat Mode DataGrid (ê¸°ë³¸) -->
                    <DataGrid x:Name="HierarchyDataGrid"
                              ItemsSource="{Binding FilteredHierarchicalProperties}"
                              AutoGenerateColumns="False"
                              SelectionMode="Extended"
                              SelectionUnit="FullRow"
                              AlternatingRowBackground="#FAFAFA"
                              RowBackground="White"
                              ColumnHeaderStyle="{StaticResource DataGridHeaderStyle}"
                              GridLinesVisibility="Horizontal"
                              BorderThickness="0"
                              CanUserAddRows="False"
                              Visibility="{Binding IsGroupedViewEnabled, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Invert}">
                        <DataGrid.Columns>
                            <DataGridCheckBoxColumn Header="âœ“"
                                                    Binding="{Binding IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Width="35"/>
                            <DataGridTextColumn Header="Level"
                                                Binding="{Binding Level}"
                                                Width="50" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Object"
                                                Binding="{Binding DisplayName}"
                                                Width="130" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Category"
                                                Binding="{Binding Category}"
                                                Width="100" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Property"
                                                Binding="{Binding PropertyName}"
                                                Width="100" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Raw Value"
                                                Binding="{Binding PropertyValue}"
                                                Width="150" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Refined"
                                                Binding="{Binding RawValue}"
                                                Width="*" IsReadOnly="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="#0078D4"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Unit"
                                                Binding="{Binding Unit}"
                                                Width="60" IsReadOnly="True"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Phase 12: Grouped Mode ListView (FilteredObjectGroups ì‚¬ìš©) -->
                    <ListView x:Name="GroupedListView"
                              ItemsSource="{Binding FilteredObjectGroups}"
                              VirtualizingStackPanel.IsVirtualizing="True"
                              VirtualizingStackPanel.VirtualizationMode="Recycling"
                              ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                              BorderThickness="0"
                              Background="White"
                              Visibility="{Binding IsGroupedViewEnabled, Converter={StaticResource BoolToVisibilityConverter}}">
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                <Setter Property="Padding" Value="0"/>
                                <Setter Property="Margin" Value="0"/>
                            </Style>
                        </ListView.ItemContainerStyle>
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <Expander IsExpanded="{Binding IsExpanded, Mode=TwoWay}"
                                          Background="White" BorderThickness="0,0,0,1" BorderBrush="#E0E0E0">
                                    <!-- ê·¸ë£¹ í—¤ë” -->
                                    <Expander.Header>
                                        <Grid Margin="0,4">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>

                                            <CheckBox Grid.Column="0"
                                                      IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                                      VerticalAlignment="Center"
                                                      Margin="0,0,8,0"/>

                                            <Border Grid.Column="1"
                                                    Background="#6F42C1" CornerRadius="2"
                                                    Padding="4,1" Margin="0,0,8,0">
                                                <TextBlock Text="{Binding LevelBadge}"
                                                           Foreground="White" FontSize="10" FontWeight="Bold"/>
                                            </Border>

                                            <TextBlock Grid.Column="2"
                                                       VerticalAlignment="Center">
                                                <Run Text="{Binding DisplayName, Mode=OneWay}" FontWeight="SemiBold" FontSize="13"/>
                                                <Run Text="{Binding FilteredPropertyCount, StringFormat=' ({0} props)', Mode=OneWay}" Foreground="#666"/>
                                            </TextBlock>

                                            <TextBlock Grid.Column="3"
                                                       VerticalAlignment="Center"
                                                       Foreground="#28A745" FontSize="11"
                                                       Margin="8,0"
                                                       Visibility="{Binding IsSelected, Converter={StaticResource BoolToVisibilityConverter}}">
                                                <Run Text="âœ“ Selected"/>
                                            </TextBlock>
                                        </Grid>
                                    </Expander.Header>

                                    <!-- í•„í„°ë§ëœ ì†ì„± ëª©ë¡ (í™•ìž¥ ì‹œ) -->
                                    <DataGrid ItemsSource="{Binding FilteredProperties}"
                                              AutoGenerateColumns="False"
                                              CanUserAddRows="False"
                                              HeadersVisibility="None"
                                              GridLinesVisibility="None"
                                              Background="#FAFAFA"
                                              BorderThickness="0"
                                              Margin="32,0,0,4"
                                              MaxHeight="300">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Binding="{Binding Category}" Width="100" IsReadOnly="True">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="Foreground" Value="#6F42C1"/>
                                                        <Setter Property="FontWeight" Value="SemiBold"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Binding="{Binding PropertyName}" Width="100" IsReadOnly="True"/>
                                            <DataGridTextColumn Binding="{Binding PropertyValue}" Width="150" IsReadOnly="True"/>
                                            <DataGridTextColumn Binding="{Binding RawValue}" Width="*" IsReadOnly="True">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="Foreground" Value="#0078D4"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Binding="{Binding Unit}" Width="50" IsReadOnly="True">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="Foreground" Value="#999"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Expander>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </Grid>
            </Border>

            <!-- ë‚´ë³´ë‚´ê¸° ë° 3D ì„ íƒ ë²„íŠ¼ -->
            <Border Grid.Row="5" Background="#F8F9FA" Padding="8" Margin="0,8,0,0" CornerRadius="4">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- CSV ë‚´ë³´ë‚´ê¸° ë²„íŠ¼ (4ì¢… ë²„íŠ¼ ì²´ê³„) -->
                    <StackPanel Grid.Row="0" Grid.Column="0">
                        <!-- Row 1: All (ì „ì²´ ëª¨ë¸) -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                            <TextBlock Text="All:" VerticalAlignment="Center" Width="60" FontWeight="SemiBold" FontSize="11"/>
                            <Button Content="ðŸ“Š Properties"
                                    Style="{StaticResource ActionButton}"
                                    Command="{Binding ExportAllPropertiesCommand}"
                                    ToolTip="ì „ì²´ ëª¨ë¸ì˜ ëª¨ë“  ì†ì„±ì„ CSVë¡œ ë‚´ë³´ë‚´ê¸°"
                                    Width="100"/>
                            <Button Content="ðŸ“ Hierarchy"
                                    Style="{StaticResource SuccessButton}"
                                    Command="{Binding ExportAllHierarchyCommand}"
                                    ToolTip="ì „ì²´ ëª¨ë¸ì˜ ê³„ì¸µ êµ¬ì¡°ë¥¼ CSV/JSONìœ¼ë¡œ ë‚´ë³´ë‚´ê¸°"
                                    Width="100"/>
                        </StackPanel>
                        <!-- Row 2: Selection (ì„ íƒ ê°ì²´) -->
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Selection:" VerticalAlignment="Center" Width="60" FontWeight="SemiBold" FontSize="11"/>
                            <Button Content="ðŸ“Š Properties"
                                    Style="{StaticResource ActionButton}"
                                    Command="{Binding ExportSelectionPropertiesCommand}"
                                    ToolTip="ì„ íƒëœ ê°ì²´ì˜ ì†ì„±ì„ CSVë¡œ ë‚´ë³´ë‚´ê¸° (Navisworksì—ì„œ ê°ì²´ ì„ íƒ í•„ìš”)"
                                    Width="100"/>
                            <Button Content="ðŸ“ Hierarchy"
                                    Style="{StaticResource SuccessButton}"
                                    Command="{Binding ExportSelectionHierarchyCommand}"
                                    ToolTip="ì„ íƒëœ ê°ì²´ì˜ ê³„ì¸µ êµ¬ì¡°ë¥¼ CSV/JSONìœ¼ë¡œ ë‚´ë³´ë‚´ê¸°"
                                    Width="100"/>
                        </StackPanel>
                        <!-- Row 3: Geometry Export (Phase 15) -->
                        <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                            <TextBlock Text="Geometry:" VerticalAlignment="Center" Width="60" FontWeight="SemiBold" FontSize="11"/>
                            <Button Content="ðŸ”² All BBox"
                                    Style="{StaticResource ActionButton}"
                                    Background="#9C27B0"
                                    Command="{Binding ExportGeometryCommand}"
                                    ToolTip="ì „ì²´ ëª¨ë¸ì˜ BoundingBoxë¥¼ manifest.jsonìœ¼ë¡œ ë‚´ë³´ë‚´ê¸° (3D ë·°ì–´ ì—°ë™ìš©)"
                                    Width="100"/>
                            <Button Content="ðŸ”² Selection"
                                    Style="{StaticResource ActionButton}"
                                    Background="#7B1FA2"
                                    Command="{Binding ExportSelectionGeometryCommand}"
                                    ToolTip="ì„ íƒëœ ê°ì²´ì˜ BoundingBoxë¥¼ manifest.jsonìœ¼ë¡œ ë‚´ë³´ë‚´ê¸°"
                                    Width="100"/>
                        </StackPanel>
                        <!-- Row 4: Unified CSV Export (Phase 16 - Ontology ì—°ë™) -->
                        <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                            <TextBlock Text="Ontology:" VerticalAlignment="Center" Width="60" FontWeight="SemiBold" FontSize="11"/>
                            <Button Content="ðŸ“Š All Unified"
                                    Style="{StaticResource ActionButton}"
                                    Background="#E65100"
                                    Command="{Binding ExportUnifiedCsvCommand}"
                                    ToolTip="Hierarchy + Geometry í†µí•© CSV (bim-ontology ì—°ë™ìš©)"
                                    Width="100"/>
                            <Button Content="ðŸ“Š Selection"
                                    Style="{StaticResource ActionButton}"
                                    Background="#BF360C"
                                    Command="{Binding ExportSelectionUnifiedCsvCommand}"
                                    ToolTip="ì„ íƒ ê°ì²´ì˜ Hierarchy + Geometry í†µí•© CSV"
                                    Width="100"/>
                        </StackPanel>
                        <!-- Row 5: Spatial Adjacency Export (Phase 17) -->
                        <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                            <TextBlock Text="Spatial:" VerticalAlignment="Center" Width="60" FontWeight="SemiBold" FontSize="11"/>
                            <Button Content="ðŸ”— All Adjacency"
                                    Style="{StaticResource ActionButton}"
                                    Background="#00695C"
                                    Command="{Binding ExportAdjacencyCommand}"
                                    ToolTip="ì „ì²´ ëª¨ë¸ BBox ì¸ì ‘ì„± ë¶„ì„ (adjacency.csv + connected_groups.csv + TTL)"
                                    Width="100"/>
                            <Button Content="ðŸ”— Selection"
                                    Style="{StaticResource ActionButton}"
                                    Background="#004D40"
                                    Command="{Binding ExportSelectionAdjacencyCommand}"
                                    ToolTip="ì„ íƒ ê°ì²´ì˜ BBox ì¸ì ‘ì„± ë¶„ì„"
                                    Width="100"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- 3D ì„ íƒ ë²„íŠ¼ (Phase 3) -->
                    <StackPanel Grid.Row="0" Grid.Column="2" Orientation="Horizontal">
                        <Button Content="ðŸŽ¯ Select in 3D"
                                Style="{StaticResource ActionButton}"
                                Command="{Binding SelectIn3DCommand}"
                                ToolTip="í•„í„°ë§ëœ ê°ì²´ë¥¼ Navisworks 3D ë·°ì—ì„œ ì„ íƒ"/>
                        <!-- v0.4.3: Show Only í† ê¸€ ë²„íŠ¼ -->
                        <Button Content="{Binding ShowOnlyButtonText}"
                                Command="{Binding ShowOnlyFilteredCommand}"
                                ToolTip="Show Only í† ê¸€ (On: í•„í„°ë§ ê°ì²´ë§Œ í‘œì‹œ / Off: ì „ì²´ í‘œì‹œ)"
                                Padding="12,8" Margin="3" BorderThickness="0" FontWeight="SemiBold" Cursor="Hand"
                                Foreground="White">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Background" Value="#0078D4"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsShowOnlyActive}" Value="True">
                                            <Setter Property="Background" Value="#FF5722"/>
                                        </DataTrigger>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#005A9E"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                        </Button>
                        <Button Content="ðŸ” Zoom"
                                Style="{StaticResource ActionButton}"
                                Command="{Binding ZoomToFilteredCommand}"
                                ToolTip="í•„í„°ë§ëœ ê°ì²´ë¡œ ì¹´ë©”ë¼ ì¤Œ"/>
                    </StackPanel>

                    <!-- ìŠ¤ëƒ…ìƒ· ë²„íŠ¼ (Phase 4) -->
                    <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="3" Orientation="Horizontal" Margin="0,6,0,0">
                        <TextBlock Text="ðŸ“¸ Snapshot:" VerticalAlignment="Center" Margin="0,0,8,0" FontWeight="SemiBold"/>
                        <Button Content="ðŸ“· Capture View"
                                Style="{StaticResource ActionButton}"
                                Command="{Binding CaptureViewCommand}"
                                ToolTip="í˜„ìž¬ 3D ë·°ë¥¼ ì´ë¯¸ì§€ë¡œ ìº¡ì²˜"/>
                        <Button Content="ðŸ“ Save ViewPoint"
                                Style="{StaticResource ActionButton}"
                                Command="{Binding SaveViewPointCommand}"
                                ToolTip="í˜„ìž¬ ë·°í¬ì¸íŠ¸ë¥¼ ì €ìž¥"/>
                        <Button Content="ðŸ“¸ Capture + ViewPoint"
                                Style="{StaticResource SuccessButton}"
                                Command="{Binding CaptureWithViewPointCommand}"
                                ToolTip="ì´ë¯¸ì§€ ìº¡ì²˜ì™€ ë·°í¬ì¸íŠ¸ë¥¼ í•¨ê»˜ ì €ìž¥"/>
                        <Button Content="ðŸŽ¬ Batch Capture"
                                Style="{StaticResource ActionButton}"
                                Command="{Binding BatchCaptureCommand}"
                                ToolTip="í•„í„°ë§ëœ ê°ì²´ë“¤ì„ ê°œë³„ ìº¡ì²˜"/>
                        <Button Content="ðŸ  Reset Home"
                                Style="{StaticResource FilterButton}"
                                Command="{Binding ResetToHomeCommand}"
                                ToolTip="ê´€ì¸¡ì ì„ ì´ˆê¸° ìƒíƒœë¡œ ë¦¬ì…‹ (Home ë·°í¬ì¸íŠ¸ ë˜ëŠ” Zoom Extents)"/>
                    </StackPanel>

                    <!-- ìƒíƒœ ë©”ì‹œì§€ -->
                    <TextBlock Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3"
                               Text="{Binding StatusMessage}"
                               VerticalAlignment="Center" Margin="0,6,0,0"
                               FontSize="11" Foreground="#666666"/>
                </Grid>
            </Border>
        </Grid>

        <GridSplitter Grid.Column="3" Width="5" HorizontalAlignment="Stretch" Background="#CCCCCC"/>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- ì˜¤ë¥¸ìª½ íŒ¨ë„: Filter & Search Set -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <TabControl Grid.Column="4" Background="White">

            <!-- íƒ­ 1: Search Set ìƒì„± -->
            <TabItem Header="ðŸ” Search Set">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="12">
                        <TextBlock Text="Search Set ìƒì„±" Style="{StaticResource SectionTitle}"/>
                        <TextBlock Text="í•„í„°ë§ëœ ë°ì´í„°ë¡œ Navisworks ê²€ìƒ‰ ì„¸íŠ¸ ìƒì„±"
                                   Style="{StaticResource LabelStyle}" Margin="0,0,0,15"/>

                        <!-- ì„ íƒ ìƒíƒœ -->
                        <Border Background="#E6F3FF" BorderBrush="#0078D4" BorderThickness="1"
                                Padding="12" Margin="0,0,0,15" CornerRadius="4">
                            <StackPanel>
                                <TextBlock Text="ì„ íƒëœ í•­ëª©" FontWeight="SemiBold" Margin="0,0,0,8"/>
                                <TextBlock Text="{Binding SelectedPropertiesCount, FallbackValue='0ê°œ ì„ íƒë¨'}"
                                           FontSize="18" FontWeight="Bold" Foreground="#0078D4"/>
                            </StackPanel>
                        </Border>

                        <!-- í´ë” ì´ë¦„ -->
                        <TextBlock Text="í´ë” ì´ë¦„" Style="{StaticResource LabelStyle}"/>
                        <TextBox Text="{Binding FolderName, UpdateSourceTrigger=PropertyChanged}"
                                 Height="30" Margin="0,0,0,12" Padding="8,5"
                                 InputMethod.IsInputMethodEnabled="True"
                                 PreviewKeyDown="TextBox_PreviewKeyDown"
                                 GotFocus="TextBox_GotFocus"/>

                        <!-- ì„¸íŠ¸ ì´ë¦„ -->
                        <TextBlock Text="ì„¸íŠ¸ ì´ë¦„" Style="{StaticResource LabelStyle}"/>
                        <TextBox Text="{Binding NewSetName, UpdateSourceTrigger=PropertyChanged}"
                                 Height="30" Margin="0,0,0,15" Padding="8,5"
                                 InputMethod.IsInputMethodEnabled="True"
                                 PreviewKeyDown="TextBox_PreviewKeyDown"
                                 GotFocus="TextBox_GotFocus"/>

                        <!-- ì„ íƒëœ ì†ì„± ë¯¸ë¦¬ë³´ê¸° -->
                        <TextBlock Text="ì„ íƒëœ ì†ì„± ë¯¸ë¦¬ë³´ê¸°" Style="{StaticResource LabelStyle}"/>
                        <Border Background="#F8F9FA" BorderBrush="#DDDDDD" BorderThickness="1"
                                Padding="10" Margin="0,0,0,15" MaxHeight="200">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <TextBlock Text="{Binding SelectedPropertyInfo, FallbackValue='(Hierarchy Dataì—ì„œ í•­ëª©ì„ ì„ íƒí•˜ì„¸ìš”)'}"
                                           TextWrapping="Wrap" FontSize="11" Foreground="#666666"/>
                            </ScrollViewer>
                        </Border>

                        <!-- ìƒì„± ë²„íŠ¼ -->
                        <Button Content="ðŸ” Search Set ìƒì„±"
                                Style="{StaticResource SuccessButton}"
                                HorizontalAlignment="Stretch"
                                Height="40"
                                Command="{Binding CreateSearchSetCommand}"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- íƒ­ 2: CSV Viewer (v0.5.0) -->
            <TabItem Header="ðŸ“Š CSV Viewer">
                <Grid Margin="8">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- í—¤ë” -->
                    <StackPanel Grid.Row="0" Margin="0,0,0,8">
                        <TextBlock Text="CSV Viewer" Style="{StaticResource SectionTitle}"/>
                        <TextBlock Text="{Binding CsvViewer.FileName, FallbackValue='(No file loaded)'}"
                                   Style="{StaticResource LabelStyle}" FontStyle="Italic"/>
                    </StackPanel>

                    <!-- ë¡œë“œ/í•„í„° ì»¨íŠ¸ë¡¤ -->
                    <Border Grid.Row="1" Background="#E8F4FD" Padding="8" Margin="0,0,0,8" CornerRadius="4">
                        <StackPanel>
                            <!-- íŒŒì¼ ë¡œë“œ ë²„íŠ¼ -->
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                <Button Content="ðŸ“‚ Load CSV"
                                        Style="{StaticResource ActionButton}"
                                        Command="{Binding CsvViewer.LoadCsvCommand}"
                                        Width="90"/>
                                <Button Content="âœ• Clear"
                                        Style="{StaticResource FilterButton}"
                                        Command="{Binding CsvViewer.ClearDataCommand}"
                                        Width="60"/>
                                <Button Content="ðŸ“¤ Export"
                                        Style="{StaticResource SuccessButton}"
                                        Command="{Binding CsvViewer.ExportFilteredCommand}"
                                        ToolTip="Export filtered data to new CSV"
                                        Width="70"/>
                            </StackPanel>

                            <!-- í•„í„° -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="80"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Column="0" Text="Filter:" VerticalAlignment="Center"
                                           FontWeight="SemiBold" Margin="0,0,6,0"/>
                                <ComboBox Grid.Column="1"
                                          ItemsSource="{Binding CsvViewer.ColumnNames}"
                                          SelectedItem="{Binding CsvViewer.SelectedFilterColumn}"
                                          Height="26" Margin="0,0,4,0" FontSize="10"/>
                                <TextBox Grid.Column="2"
                                         Text="{Binding CsvViewer.FilterText, UpdateSourceTrigger=PropertyChanged}"
                                         Height="26" Padding="6,4"
                                         VerticalContentAlignment="Center"
                                         InputMethod.IsInputMethodEnabled="True"
                                         PreviewKeyDown="TextBox_PreviewKeyDown"
                                         GotFocus="TextBox_GotFocus"/>
                                <Button Grid.Column="3" Content="âœ•"
                                        Width="26" Height="26" Margin="4,0,0,0"
                                        Command="{Binding CsvViewer.ClearFilterCommand}"
                                        ToolTip="Clear filter"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- DataGrid -->
                    <Border Grid.Row="2" BorderBrush="#DDDDDD" BorderThickness="1" Background="White">
                        <DataGrid ItemsSource="{Binding CsvViewer.FilteredView}"
                                  AutoGenerateColumns="True"
                                  IsReadOnly="True"
                                  SelectionMode="Extended"
                                  SelectionUnit="FullRow"
                                  AlternatingRowBackground="#FAFAFA"
                                  RowBackground="White"
                                  ColumnHeaderStyle="{StaticResource DataGridHeaderStyle}"
                                  GridLinesVisibility="Horizontal"
                                  BorderThickness="0"
                                  CanUserAddRows="False"
                                  CanUserDeleteRows="False"
                                  CanUserReorderColumns="True"
                                  CanUserResizeColumns="True"
                                  CanUserSortColumns="True"
                                  FontSize="11"/>
                    </Border>

                    <!-- ìƒíƒœ í‘œì‹œì¤„ -->
                    <TextBlock Grid.Row="3"
                               Text="{Binding CsvViewer.StatusMessage, FallbackValue='Ready'}"
                               Margin="0,6,0,0" FontSize="10" Foreground="#666666"/>
                </Grid>
            </TabItem>

            <!-- íƒ­ 3: AWP 4D Automation (Phase 8) -->
            <TabItem Header="â±ï¸ AWP 4D">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="12">
                        <TextBlock Text="AWP 4D Automation" Style="{StaticResource SectionTitle}"/>
                        <TextBlock Text="CSV ìŠ¤ì¼€ì¤„ â†’ TimeLiner ìžë™ ì—°ê²°"
                                   Style="{StaticResource LabelStyle}" Margin="0,0,0,15"/>

                        <!-- CSV íŒŒì¼ ì„ íƒ -->
                        <Border Background="#E8F4FD" Padding="12" Margin="0,0,0,12" CornerRadius="4">
                            <StackPanel>
                                <TextBlock Text="Schedule CSV File" FontWeight="SemiBold" Margin="0,0,0,8"/>
                                <StackPanel Orientation="Horizontal">
                                    <Button Content="ðŸ“‚ Browse"
                                            Style="{StaticResource ActionButton}"
                                            Command="{Binding AWP4D.BrowseCsvCommand}"
                                            Width="80" Height="30"/>
                                    <TextBlock Text="{Binding AWP4D.CsvFileName, FallbackValue='(No file selected)'}"
                                               VerticalAlignment="Center" Margin="10,0,0,0"
                                               FontSize="11" Foreground="#666666"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>

                        <!-- ì˜µì…˜ -->
                        <Border Background="#F8F9FA" BorderBrush="#DDDDDD" BorderThickness="1"
                                Padding="12" Margin="0,0,0,12" CornerRadius="4">
                            <StackPanel>
                                <TextBlock Text="Pipeline Options" FontWeight="SemiBold" Margin="0,0,0,10"/>

                                <CheckBox Content="Property Write (ComAPI)"
                                          IsChecked="{Binding AWP4D.EnablePropertyWrite}"
                                          Margin="0,0,0,6"/>
                                <CheckBox Content="Selection Set ìƒì„±"
                                          IsChecked="{Binding AWP4D.EnableSelectionSetCreation}"
                                          Margin="0,0,0,6"/>
                                <CheckBox Content="TimeLiner Task ìƒì„±"
                                          IsChecked="{Binding AWP4D.EnableTimeLinerTaskCreation}"
                                          Margin="0,0,0,10"/>

                                <TextBlock Text="Grouping Strategy" Style="{StaticResource LabelStyle}"/>
                                <ComboBox ItemsSource="{Binding AWP4D.GroupingStrategies}"
                                          SelectedItem="{Binding AWP4D.SelectedGroupingStrategy}"
                                          Height="26" Margin="0,0,0,10"/>

                                <TextBlock Text="Min Match Rate (%)" Style="{StaticResource LabelStyle}"/>
                                <TextBox Text="{Binding AWP4D.MinMatchSuccessRate, UpdateSourceTrigger=PropertyChanged}"
                                         Height="26" Padding="6,4" Margin="0,0,0,10"
                                         InputMethod.IsInputMethodEnabled="True"
                                         PreviewKeyDown="TextBox_PreviewKeyDown"
                                         GotFocus="TextBox_GotFocus"/>

                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0" Margin="0,0,5,0">
                                        <TextBlock Text="Set Folder" Style="{StaticResource LabelStyle}"/>
                                        <TextBox Text="{Binding AWP4D.SelectionSetRootFolder, UpdateSourceTrigger=PropertyChanged}"
                                                 Height="26" Padding="6,4"
                                                 InputMethod.IsInputMethodEnabled="True"
                                                 PreviewKeyDown="TextBox_PreviewKeyDown"
                                                 GotFocus="TextBox_GotFocus"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1" Margin="5,0,0,0">
                                        <TextBlock Text="Task Folder" Style="{StaticResource LabelStyle}"/>
                                        <TextBox Text="{Binding AWP4D.TimeLinerRootFolder, UpdateSourceTrigger=PropertyChanged}"
                                                 Height="26" Padding="6,4"
                                                 InputMethod.IsInputMethodEnabled="True"
                                                 PreviewKeyDown="TextBox_PreviewKeyDown"
                                                 GotFocus="TextBox_GotFocus"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- ì‹¤í–‰ ë²„íŠ¼ -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                            <Button Content="â–¶ Execute"
                                    Style="{StaticResource SuccessButton}"
                                    Command="{Binding AWP4D.ExecuteCommand}"
                                    Width="100" Height="35"/>
                            <Button Content="ðŸ” Validate"
                                    Style="{StaticResource FilterButton}"
                                    Command="{Binding AWP4D.ValidateCommand}"
                                    Width="80" Height="35" Margin="5,0,0,0"/>
                            <CheckBox Content="Dry Run"
                                      IsChecked="{Binding AWP4D.IsDryRun}"
                                      VerticalAlignment="Center" Margin="10,0,0,0"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                            <Button Content="â¹ Cancel"
                                    Style="{StaticResource FilterButton}"
                                    Command="{Binding AWP4D.CancelCommand}"
                                    Width="80" Height="30"/>
                            <Button Content="ðŸ—‘ Clear Results"
                                    Style="{StaticResource FilterButton}"
                                    Command="{Binding AWP4D.ClearResultsCommand}"
                                    Width="100" Height="30" Margin="5,0,0,0"/>
                            <Button Content="ðŸ§¹ Clear AWP Data"
                                    Style="{StaticResource FilterButton}"
                                    Command="{Binding AWP4D.ClearExistingDataCommand}"
                                    Width="110" Height="30" Margin="5,0,0,0"
                                    ToolTip="Delete all AWP Selection Sets and TimeLiner Tasks"/>
                        </StackPanel>

                        <!-- ì§„í–‰ë¥  -->
                        <Border Background="#F0F0F0" Padding="10" Margin="0,0,0,12" CornerRadius="4"
                                Visibility="{Binding AWP4D.IsRunning, Converter={StaticResource BoolToVisibilityConverter}}">
                            <StackPanel>
                                <TextBlock Text="{Binding AWP4D.CurrentPhase, FallbackValue='Ready'}"
                                           FontWeight="SemiBold" Margin="0,0,0,6"/>
                                <ProgressBar Value="{Binding AWP4D.ProgressPercentage}"
                                             Minimum="0" Maximum="100" Height="18"/>
                                <TextBlock Text="{Binding AWP4D.StatusMessage}"
                                           FontSize="10" Foreground="#666666" Margin="0,4,0,0"/>
                            </StackPanel>
                        </Border>

                        <!-- ë¡œê·¸ -->
                        <Border Background="White" BorderBrush="#DDDDDD" BorderThickness="1"
                                Padding="8" CornerRadius="4" MaxHeight="150">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <ItemsControl ItemsSource="{Binding AWP4D.LogEntries}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock FontSize="10" TextWrapping="Wrap" Margin="0,1">
                                                <Run Text="{Binding Timestamp, StringFormat='[{0:HH:mm:ss}]', Mode=OneWay}" Foreground="#999999"/>
                                                <Run Text="{Binding Message, Mode=OneWay}"/>
                                            </TextBlock>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </ScrollViewer>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- íƒ­ 4: Schedule Builder (Phase 10) -->
            <TabItem Header="ðŸ“… Schedule">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="12">
                        <TextBlock Text="Schedule Builder" FontSize="16" FontWeight="Bold"
                                   Foreground="#0078D4" Margin="0,0,0,12"/>

                        <!-- ì„ íƒ ìƒíƒœ í‘œì‹œ -->
                        <Border Background="#E3F2FD" Padding="12" Margin="0,0,0,12" CornerRadius="4">
                            <StackPanel>
                                <TextBlock FontWeight="SemiBold">
                                    <Run Text="ì„ íƒëœ ê°ì²´: "/>
                                    <Run Text="{Binding ScheduleBuilder.SelectedCount, FallbackValue=0, Mode=OneWay}" Foreground="#0078D4" FontWeight="Bold"/>
                                    <Run Text=" ê°œ"/>
                                </TextBlock>
                                <TextBlock Text="{Binding ScheduleBuilder.StatusMessage, FallbackValue='ì„ íƒëœ í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤.'}"
                                           FontSize="11" Foreground="#666666" Margin="0,4,0,0"/>
                            </StackPanel>
                        </Border>

                        <!-- ì˜µì…˜ ì„¤ì • -->
                        <Border Background="#F8F9FA" Padding="12" Margin="0,0,0,12" CornerRadius="4">
                            <StackPanel>
                                <TextBlock Text="Task ì„¤ì •" FontWeight="Bold" Margin="0,0,0,10"/>

                                <!-- Task Name Prefix -->
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Task Prefix" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Text="{Binding ScheduleBuilder.TaskNamePrefix, UpdateSourceTrigger=PropertyChanged}"
                                             Height="26" Padding="6,4"
                                             InputMethod.IsInputMethodEnabled="True"
                                             PreviewKeyDown="TextBox_PreviewKeyDown"
                                             GotFocus="TextBox_GotFocus"/>
                                </Grid>

                                <!-- Task Type -->
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Task Type" VerticalAlignment="Center"/>
                                    <ComboBox Grid.Column="1" ItemsSource="{Binding ScheduleBuilder.TaskTypes}"
                                              SelectedItem="{Binding ScheduleBuilder.SelectedTaskType}"
                                              Height="26"/>
                                </Grid>

                                <!-- Duration -->
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="30"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Duration" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Text="{Binding ScheduleBuilder.DurationPerTask, UpdateSourceTrigger=PropertyChanged}"
                                             Height="26" Padding="6,4"
                                             InputMethod.IsInputMethodEnabled="True"
                                             PreviewKeyDown="TextBox_PreviewKeyDown"
                                             GotFocus="TextBox_GotFocus"/>
                                    <TextBlock Grid.Column="2" Text="ì¼" VerticalAlignment="Center" Margin="6,0,0,0"/>
                                </Grid>

                                <!-- Start Date -->
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Start Date" VerticalAlignment="Center"/>
                                    <DatePicker Grid.Column="1" SelectedDate="{Binding ScheduleBuilder.StartDate}"
                                                Height="26"/>
                                </Grid>

                                <!-- Date Mode (Phase 13) -->
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Date Mode" VerticalAlignment="Center"/>
                                    <ComboBox Grid.Column="1"
                                              ItemsSource="{Binding ScheduleBuilder.DateModeOptions}"
                                              SelectedValue="{Binding ScheduleBuilder.SelectedDateMode}"
                                              SelectedValuePath="Mode"
                                              DisplayMemberPath="DisplayName"
                                              Height="26"
                                              ToolTip="TimeLiner ë‚ ì§œ ì„¤ì • ë°©ì‹"/>
                                </Grid>

                                <!-- ParentSet Strategy -->
                                <TextBlock Text="ParentSet ì „ëžµ" FontWeight="Bold" Margin="0,12,0,8"/>
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Strategy" VerticalAlignment="Center"/>
                                    <ComboBox Grid.Column="1" ItemsSource="{Binding ScheduleBuilder.ParentSetStrategies}"
                                              SelectedItem="{Binding ScheduleBuilder.ParentSetStrategy}"
                                              Height="26"/>
                                </Grid>

                                <!-- Level (ByLevel ì „ëžµ ì‹œ) -->
                                <Grid Margin="0,0,0,8"
                                      Visibility="{Binding ScheduleBuilder.IsLevelStrategySelected, Converter={StaticResource BoolToVisibilityConverter}}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Level" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Text="{Binding ScheduleBuilder.ParentSetLevel, UpdateSourceTrigger=PropertyChanged}"
                                             Height="26" Padding="6,4"
                                             InputMethod.IsInputMethodEnabled="True"
                                             PreviewKeyDown="TextBox_PreviewKeyDown"
                                             GotFocus="TextBox_GotFocus"/>
                                </Grid>

                                <!-- Custom ParentSet (Custom ì „ëžµ ì‹œ) -->
                                <Grid Margin="0,0,0,8"
                                      Visibility="{Binding ScheduleBuilder.IsCustomStrategySelected, Converter={StaticResource BoolToVisibilityConverter}}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Custom Set" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Text="{Binding ScheduleBuilder.CustomParentSet, UpdateSourceTrigger=PropertyChanged}"
                                             Height="26" Padding="6,4"
                                             InputMethod.IsInputMethodEnabled="True"
                                             PreviewKeyDown="TextBox_PreviewKeyDown"
                                             GotFocus="TextBox_GotFocus"/>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- ì‹¤í–‰ ë²„íŠ¼ -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                            <Button Content="ðŸ”„ Refresh"
                                    Style="{StaticResource FilterButton}"
                                    Command="{Binding ScheduleBuilder.RefreshPreviewCommand}"
                                    Width="80" Height="28"/>
                            <Button Content="ðŸ’¾ CSV"
                                    Style="{StaticResource SuccessButton}"
                                    Command="{Binding ScheduleBuilder.GenerateCsvCommand}"
                                    Width="70" Height="28" Margin="6,0,0,0"
                                    ToolTip="Schedule CSV íŒŒì¼ ì €ìž¥"/>
                            <Button Content="â–¶ Temp CSV"
                                    Style="{StaticResource ActionButton}"
                                    Command="{Binding ScheduleBuilder.ExecuteToTimeLinerCommand}"
                                    Width="85" Height="28" Margin="6,0,0,0"
                                    ToolTip="ìž„ì‹œ CSV ìƒì„± í›„ AWP 4D íƒ­ì—ì„œ ë¡œë“œ"/>
                        </StackPanel>

                        <!-- Phase 13: ì§ì ‘ ì‹¤í–‰ ì„¹ì…˜ -->
                        <Border Background="#E8F5E9" Padding="10" Margin="0,0,0,12" CornerRadius="4">
                            <StackPanel>
                                <TextBlock Text="âš¡ Direct TimeLiner Execution" FontWeight="SemiBold" Foreground="#2E7D32" Margin="0,0,0,8"/>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <CheckBox Content="DryRun (ë¯¸ë¦¬ë³´ê¸°ë§Œ)"
                                              IsChecked="{Binding ScheduleBuilder.IsDryRunMode}"
                                              VerticalAlignment="Center"
                                              ToolTip="ì²´í¬í•˜ë©´ ì‹¤ì œ ì‹¤í–‰ ì—†ì´ ê²°ê³¼ë¥¼ ë¯¸ë¦¬ í™•ì¸í•©ë‹ˆë‹¤"/>
                                    <Button Content="ðŸš€ ì§ì ‘ ì‹¤í–‰"
                                            Background="#2E7D32" Foreground="White"
                                            Command="{Binding ScheduleBuilder.DirectExecuteCommand}"
                                            Width="100" Height="28" Margin="12,0,0,0"
                                            ToolTip="CSV ì—†ì´ ì§ì ‘ TimeLinerì— ì—°ê²°"
                                            IsEnabled="{Binding ScheduleBuilder.CanExecute}"/>
                                </StackPanel>
                                <!-- ì§„í–‰ë¥  í‘œì‹œ -->
                                <Grid Visibility="{Binding ScheduleBuilder.IsExecuting, Converter={StaticResource BoolToVisibilityConverter}}">
                                    <ProgressBar Value="{Binding ScheduleBuilder.ExecutionProgress}"
                                                 Minimum="0" Maximum="100"
                                                 Height="6" Background="#C8E6C9" Foreground="#2E7D32"/>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- ì˜ˆìƒ ê¸°ê°„ í‘œì‹œ -->
                        <Border Background="#FFF3E0" Padding="10" Margin="0,0,0,12" CornerRadius="4"
                                Visibility="{Binding ScheduleBuilder.SelectedCount, Converter={StaticResource BoolToVisibilityConverter}}">
                            <TextBlock>
                                <Run Text="ì˜ˆìƒ ì´ ê¸°ê°„: "/>
                                <Run Text="{Binding ScheduleBuilder.TotalDuration, FallbackValue=0, Mode=OneWay}" FontWeight="Bold" Foreground="#E65100"/>
                                <Run Text=" ì¼"/>
                            </TextBlock>
                        </Border>

                        <!-- ë¯¸ë¦¬ë³´ê¸° DataGrid -->
                        <Border Background="White" BorderBrush="#DDDDDD" BorderThickness="1"
                                Padding="1" CornerRadius="4" MaxHeight="200">
                            <DataGrid ItemsSource="{Binding ScheduleBuilder.PreviewItems}"
                                      AutoGenerateColumns="False"
                                      IsReadOnly="True"
                                      CanUserAddRows="False"
                                      CanUserDeleteRows="False"
                                      RowHeight="24"
                                      HeadersVisibility="Column"
                                      GridLinesVisibility="Horizontal"
                                      HorizontalGridLinesBrush="#EEEEEE"
                                      AlternatingRowBackground="#FAFAFA"
                                      EnableRowVirtualization="True">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Task" Binding="{Binding TaskName}" Width="70"/>
                                    <DataGridTextColumn Header="Planned Start" Binding="{Binding PlannedStart, StringFormat='yyyy-MM-dd'}" Width="85"/>
                                    <DataGridTextColumn Header="Planned End" Binding="{Binding PlannedEnd, StringFormat='yyyy-MM-dd'}" Width="85"/>
                                    <DataGridTextColumn Header="Actual" Binding="{Binding ActualDateDisplay}" Width="70">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Foreground" Value="#28A745"/>
                                                <Setter Property="FontSize" Value="10"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="Type" Binding="{Binding TaskType}" Width="50"/>
                                    <DataGridTextColumn Header="Set" Binding="{Binding ParentSet}" Width="60"/>
                                    <DataGridTextColumn Header="Original" Binding="{Binding OriginalDisplayName}" Width="*"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Border>

                        <!-- ì‚¬ìš©ë²• ì•ˆë‚´ -->
                        <Border Background="#F0F0F0" Padding="10" Margin="0,12,0,0" CornerRadius="4">
                            <StackPanel>
                                <TextBlock Text="ì‚¬ìš© ë°©ë²•" FontWeight="Bold" Margin="0,0,0,6"/>
                                <TextBlock Text="1. ì¤‘ì•™ íŒ¨ë„ì—ì„œ ê°ì²´ë¥¼ ì„ íƒ (ì²´í¬ë°•ìŠ¤)" FontSize="10" Foreground="#666666"/>
                                <TextBlock Text="2. Task ì„¤ì • (ì´ë¦„, ê¸°ê°„, ì‹œìž‘ì¼, ParentSet)" FontSize="10" Foreground="#666666"/>
                                <TextBlock Text="3. 'Refresh Preview'ë¡œ ë¯¸ë¦¬ë³´ê¸° í™•ì¸" FontSize="10" Foreground="#666666"/>
                                <TextBlock Text="4. 'Generate CSV' ë˜ëŠ” 'To TimeLiner' ì‹¤í–‰" FontSize="10" Foreground="#666666"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- íƒ­ 5: Ontology (Phase 14) -->
            <TabItem Header="ðŸ§  Ontology">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="10">
                    <StackPanel>
                        <!-- í—¤ë” -->
                        <Border Background="#E8F4FD" Padding="12" Margin="0,0,0,10" CornerRadius="4">
                            <StackPanel>
                                <TextBlock Text="BIM Ontology System" FontSize="14" FontWeight="Bold"/>
                                <TextBlock Text="Hierarchy Data â†’ RDF â†’ Inference â†’ Schedule Automation"
                                           FontSize="11" Foreground="#666" Margin="0,4,0,0"/>
                            </StackPanel>
                        </Border>

                        <!-- í†µê³„ ì¹´ë“œ -->
                        <Border Background="White" BorderBrush="#DDD" BorderThickness="1"
                                Padding="12" Margin="0,0,0,10" CornerRadius="4">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- Triples -->
                                <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                                    <TextBlock Text="{Binding OntologyVM.TotalTriplesDisplay, FallbackValue='0'}"
                                               FontSize="24" FontWeight="Bold" Foreground="#0078D4"/>
                                    <TextBlock Text="Triples" FontSize="10" Foreground="#666"/>
                                </StackPanel>

                                <!-- Objects -->
                                <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                                    <TextBlock Text="{Binding OntologyVM.TotalObjectsDisplay, FallbackValue='0'}"
                                               FontSize="24" FontWeight="Bold" Foreground="#28A745"/>
                                    <TextBlock Text="Objects" FontSize="10" Foreground="#666"/>
                                </StackPanel>

                                <!-- Precedence -->
                                <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                                    <TextBlock Text="{Binding OntologyVM.PrecedenceCountDisplay, FallbackValue='0'}"
                                               FontSize="24" FontWeight="Bold" Foreground="#FFC107"/>
                                    <TextBlock Text="Precedence" FontSize="10" Foreground="#666"/>
                                </StackPanel>

                                <!-- Levels -->
                                <StackPanel Grid.Column="3" HorizontalAlignment="Center">
                                    <TextBlock Text="{Binding OntologyVM.LevelCountDisplay, FallbackValue='0'}"
                                               FontSize="24" FontWeight="Bold" Foreground="#DC3545"/>
                                    <TextBlock Text="Levels" FontSize="10" Foreground="#666"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- ì»¨íŠ¸ë¡¤ ë²„íŠ¼ -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                            <Button Content="Build Ontology"
                                    Command="{Binding OntologyVM.BuildOntologyCommand}"
                                    Style="{StaticResource SuccessButton}"
                                    Width="110" Height="28"/>
                            <Button Content="Run Inference"
                                    Command="{Binding OntologyVM.RunInferenceCommand}"
                                    Style="{StaticResource ActionButton}"
                                    Width="110" Height="28" Margin="6,0,0,0"/>
                            <Button Content="Export RDF"
                                    Command="{Binding OntologyVM.ExportRdfCommand}"
                                    Style="{StaticResource FilterButton}"
                                    Width="90" Height="28" Margin="6,0,0,0"/>
                            <Button Content="Clear"
                                    Command="{Binding OntologyVM.ClearOntologyCommand}"
                                    Style="{StaticResource FilterButton}"
                                    Width="60" Height="28" Margin="6,0,0,0"/>
                        </StackPanel>

                        <!-- Level í•„í„° -->
                        <Border Background="#F5F5F5" Padding="10" Margin="0,0,0,10" CornerRadius="4">
                            <StackPanel>
                                <TextBlock Text="Level Filter" FontWeight="SemiBold" Margin="0,0,0,6"/>
                                <StackPanel Orientation="Horizontal">
                                    <ComboBox ItemsSource="{Binding OntologyVM.AvailableLevels}"
                                              SelectedItem="{Binding OntologyVM.SelectedLevel}"
                                              Width="150" Height="28"/>
                                    <Button Content="Refresh"
                                            Command="{Binding OntologyVM.RefreshLevelViewCommand}"
                                            Style="{StaticResource FilterButton}"
                                            Width="70" Height="28" Margin="8,0,0,0"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>

                        <!-- ë¶„ë¥˜ ê²°ê³¼ DataGrid -->
                        <Border Background="White" BorderBrush="#DDD" BorderThickness="1"
                                Padding="10" Margin="0,0,0,10" CornerRadius="4">
                            <StackPanel>
                                <TextBlock Text="Classification Results" FontWeight="SemiBold" Margin="0,0,0,8"/>
                                <DataGrid ItemsSource="{Binding OntologyVM.CurrentNodes}"
                                          AutoGenerateColumns="False"
                                          IsReadOnly="True"
                                          MaxHeight="150"
                                          CanUserAddRows="False"
                                          HeadersVisibility="Column"
                                          GridLinesVisibility="Horizontal"
                                          AlternatingRowBackground="#FAFAFA"
                                          ColumnHeaderStyle="{StaticResource DataGridHeaderStyle}">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Name" Binding="{Binding DisplayName}" Width="*"/>
                                        <DataGridTextColumn Header="Type" Binding="{Binding RdfType}" Width="70"/>
                                        <DataGridTextColumn Header="Category" Binding="{Binding Category}" Width="90"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </StackPanel>
                        </Border>

                        <!-- ì„ í–‰ê´€ê³„ DataGrid -->
                        <Border Background="White" BorderBrush="#DDD" BorderThickness="1"
                                Padding="10" Margin="0,0,0,10" CornerRadius="4">
                            <StackPanel>
                                <TextBlock Text="Inferred Precedence Relations" FontWeight="SemiBold" Margin="0,0,0,8"/>
                                <DataGrid ItemsSource="{Binding OntologyVM.PrecedenceRelations}"
                                          AutoGenerateColumns="False"
                                          IsReadOnly="True"
                                          MaxHeight="150"
                                          CanUserAddRows="False"
                                          HeadersVisibility="Column"
                                          GridLinesVisibility="Horizontal"
                                          AlternatingRowBackground="#FAFAFA"
                                          ColumnHeaderStyle="{StaticResource DataGridHeaderStyle}">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Predecessor" Binding="{Binding PredecessorName}" Width="*"/>
                                        <DataGridTextColumn Header="â†’" Width="30">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Text" Value="â†’"/>
                                                    <Setter Property="HorizontalAlignment" Value="Center"/>
                                                    <Setter Property="Foreground" Value="#0078D4"/>
                                                    <Setter Property="FontWeight" Value="Bold"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Successor" Binding="{Binding SuccessorName}" Width="*"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </StackPanel>
                        </Border>

                        <!-- SPARQL ì¿¼ë¦¬ -->
                        <Border Background="White" BorderBrush="#DDD" BorderThickness="1"
                                Padding="10" CornerRadius="4">
                            <StackPanel>
                                <TextBlock Text="Custom SPARQL Query" FontWeight="SemiBold" Margin="0,0,0,8"/>
                                <TextBox Text="{Binding OntologyVM.CustomSparql, UpdateSourceTrigger=PropertyChanged}"
                                         Height="70" AcceptsReturn="True" TextWrapping="Wrap"
                                         FontFamily="Consolas" FontSize="10"
                                         VerticalScrollBarVisibility="Auto"/>
                                <Button Content="Execute Query"
                                        Command="{Binding OntologyVM.ExecuteQueryCommand}"
                                        Style="{StaticResource ActionButton}"
                                        Width="110" HorizontalAlignment="Left" Margin="0,8,0,8"/>
                                <TextBox Text="{Binding OntologyVM.QueryResult, Mode=OneWay}"
                                         Height="80" IsReadOnly="True" TextWrapping="Wrap"
                                         FontFamily="Consolas" FontSize="9" Background="#F5F5F5"
                                         VerticalScrollBarVisibility="Auto"/>
                            </StackPanel>
                        </Border>

                        <!-- ìƒíƒœ í‘œì‹œ -->
                        <TextBlock Text="{Binding OntologyVM.StatusMessage, FallbackValue='Ready'}"
                                   Foreground="#666" FontSize="11" Margin="0,10,0,0"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- íƒ­ 6: ì •ë³´ -->
            <TabItem Header="â„¹ï¸ Info">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="12">
                        <TextBlock Text="DXTnavis" FontSize="22" FontWeight="Bold"
                                   Foreground="#0078D4" Margin="0,0,0,5"/>
                        <TextBlock Text="Navisworks 2025 Property Viewer"
                                   FontSize="12" Foreground="#666666" Margin="0,0,0,20"/>

                        <Border Background="#F8F9FA" Padding="15" Margin="0,0,0,15" CornerRadius="4">
                            <StackPanel>
                                <TextBlock Text="ì£¼ìš” ê¸°ëŠ¥" FontWeight="Bold" FontSize="13" Margin="0,0,0,12"/>

                                <TextBlock Text="â€¢ CSV Export (4ì¢… ë²„íŠ¼)" FontWeight="SemiBold" Margin="0,0,0,3"/>
                                <TextBlock Text="  All/Selection Ã— Properties/Hierarchy ì¡°í•©"
                                           FontSize="10" Foreground="#666666" Margin="0,0,0,10"/>

                                <TextBlock Text="â€¢ Level ê¸°ë°˜ íŠ¸ë¦¬ ì œì–´" FontWeight="SemiBold" Margin="0,0,0,3"/>
                                <TextBlock Text="  L0~L5 ë²„íŠ¼ìœ¼ë¡œ íŠ¸ë¦¬ ë ˆë²¨ë³„ í™•ìž¥/ì¶•ì†Œ"
                                           FontSize="10" Foreground="#666666" Margin="0,0,0,10"/>

                                <TextBlock Text="â€¢ Category/Property í•„í„°" FontWeight="SemiBold" Margin="0,0,0,3"/>
                                <TextBlock Text="  ì¹´í…Œê³ ë¦¬, ì†ì„±ëª…, ê°’ìœ¼ë¡œ ë°ì´í„° í•„í„°ë§"
                                           FontSize="10" Foreground="#666666" Margin="0,0,0,10"/>

                                <TextBlock Text="â€¢ 3D ì„ íƒ ë° ë·°í¬ì¸íŠ¸" FontWeight="SemiBold" Margin="0,0,0,3"/>
                                <TextBlock Text="  Select in 3D, Show Only, Zoom, ViewPoint ì €ìž¥"
                                           FontSize="10" Foreground="#666666" Margin="0,0,0,10"/>

                                <TextBlock Text="â€¢ AWP 4D Automation" FontWeight="SemiBold" Margin="0,0,0,3"/>
                                <TextBlock Text="  CSV â†’ Property â†’ Selection Set â†’ TimeLiner ìžë™í™”"
                                           FontSize="10" Foreground="#666666" Margin="0,0,0,10"/>

                                <TextBlock Text="â€¢ Schedule Builder (NEW)" FontWeight="SemiBold" Margin="0,0,0,3"/>
                                <TextBlock Text="  ì„ íƒ ë°ì´í„° â†’ Schedule CSV ìžë™ ìƒì„±"
                                           FontSize="10" Foreground="#666666"/>
                            </StackPanel>
                        </Border>

                        <Border Background="White" BorderBrush="#DDDDDD" BorderThickness="1"
                                Padding="15" CornerRadius="4">
                            <StackPanel>
                                <TextBlock Text="ë²„ì „ ì •ë³´" FontWeight="Bold" Margin="0,0,0,10"/>
                                <TextBlock Text="Version: 0.8.0" FontSize="11" Margin="0,0,0,3"/>
                                <TextBlock Text="Target: Navisworks Manage 2025" FontSize="11" Margin="0,0,0,3"/>
                                <TextBlock Text="Framework: .NET Framework 4.8" FontSize="11" Margin="0,0,0,3"/>
                                <TextBlock Text="GitHub: github.com/tygwan/DXTnavis"
                                           FontSize="11" Foreground="#0078D4"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
        </TabControl>
    </Grid>
</Window>
