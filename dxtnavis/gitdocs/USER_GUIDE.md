# DXnavis 사용자 가이드

## 📘 목차
1. [시작하기](#시작하기)
2. [설치 방법](#설치-방법)
3. [주요 기능 사용법](#주요-기능-사용법)
4. [문제 해결](#문제-해결)
5. [FAQ](#faq)

---

## 🚀 시작하기

### DXnavis란?
**DXnavis**는 Navisworks Manage 2025에서 BIM 모델의 속성을 효율적으로 확인하고 관리할 수 있는 플러그인입니다.

### 주요 장점
- ✅ **실시간 속성 확인**: 선택한 객체의 모든 속성을 즉시 확인
- ✅ **계층 구조 탐색**: 모델 전체를 트리 형태로 시각화하여 탐색
- ✅ **데이터 내보내기**: 속성을 CSV/JSON 형식으로 저장
- ✅ **검색 세트 자동 생성**: 속성 기반으로 Navisworks 검색 세트 자동 생성
- ✅ **직관적 UI**: 3단 레이아웃으로 편리한 작업 환경 제공

---

## 📦 설치 방법

### 시스템 요구사항
- **OS**: Windows 10/11 (64bit)
- **필수 소프트웨어**: Autodesk Navisworks Manage 2025
- **.NET Framework**: 4.8 이상

### 설치 단계

#### 1단계: 플러그인 파일 다운로드
- `DXnavis.dll` 파일을 다운로드합니다.

#### 2단계: 플러그인 폴더에 복사
플러그인 파일을 Navisworks 플러그인 폴더에 복사합니다:
```
C:\Program Files\Autodesk\Navisworks Manage 2025\Plugins\DXnavis\
```

**폴더 생성**:
- `Plugins` 폴더가 없으면 생성합니다.
- `DXnavis` 하위 폴더를 만들고 DLL을 복사합니다.

#### 3단계: Navisworks 재시작
Navisworks Manage 2025를 **완전히 종료 후 다시 실행**합니다.

#### 4단계: 플러그인 확인
1. Navisworks 메뉴: **추가 기능(Add-Ins)** → **속성 확인기** 클릭
2. 플러그인 창이 열리면 설치 성공!

---

## 🎯 주요 기능 사용법

### 기능 1: 계층 구조 TreeView 탐색

#### 목적
모델의 전체 계층 구조를 트리 형태로 탐색하여 원하는 객체를 빠르게 찾을 수 있습니다.

#### 사용 방법

**1. 계층 구조 로드**
- **위치**: 왼쪽 패널 상단
- **버튼**: `모델 계층 로드`
- **결과**: 모델의 전체 계층 구조가 TreeView에 표시됩니다.

**2. 트리 탐색**
- **확장/축소**: 화살표 아이콘 클릭 또는 더블클릭
- **노드 선택**: 객체명 클릭
- **체크박스**: 여러 객체를 선택하여 필터링

**3. 속성 확인**
- 트리에서 노드를 선택하면 오른쪽 속성 패널에 해당 객체의 속성이 자동으로 표시됩니다.

**💡 팁**:
- 대용량 모델은 로드 시간이 소요될 수 있습니다. 진행률 바를 확인하세요.
- 특정 객체만 확인하려면 Navisworks에서 미리 선택한 후 플러그인을 실행하세요.

---

### 기능 2: 실시간 속성 확인

#### 목적
Navisworks에서 선택한 객체의 속성을 실시간으로 확인할 수 있습니다.

#### 사용 방법

**1. 객체 선택**
- Navisworks 3D 뷰에서 객체를 클릭하여 선택합니다.
- 여러 객체를 선택하려면 `Ctrl` 키를 누른 채 클릭합니다.

**2. 속성 자동 표시**
- 오른쪽 속성 패널에 선택된 객체의 모든 속성이 표시됩니다.
- 표시 항목:
  - **객체명**: 선택된 객체의 이름
  - **카테고리**: 속성 카테고리 (예: Item, Element)
  - **속성명**: 속성의 이름
  - **값**: 속성의 현재 값
  - **권한**: 읽기 전용 / 쓰기 가능

**3. 속성 검색**
- 상단 검색 창에 키워드를 입력하면 속성 목록이 필터링됩니다.

**💡 팁**:
- 빠른 연속 선택 시 마지막 선택만 처리됩니다 (Debouncing).
- 많은 속성을 가진 객체는 로딩 시간이 소요될 수 있습니다.

---

### 기능 3: 계층 구조 데이터 내보내기

#### 목적
모델의 계층 구조를 파일로 저장하여 외부에서 분석할 수 있습니다.

#### 사용 방법

**1. 내보내기 유형 선택**
왼쪽 패널 하단에서 내보내기 형식을 선택합니다:
- **CSV (Flat)**: 평면화된 CSV 파일
- **JSON (Flat)**: 배열 형태의 JSON 파일
- **JSON (Tree)**: 재귀적 트리 구조 JSON 파일

**2. 내보내기 실행**
- **버튼**: `선택 항목 내보내기` 또는 `전체 모델 내보내기`
- **선택 항목**: TreeView에서 체크한 객체만 내보내기
- **전체 모델**: 모든 객체의 속성을 내보내기

**3. 파일 저장**
- 파일 저장 대화상자가 열립니다.
- 원하는 위치와 파일명을 입력하고 저장합니다.

**4. 진행률 확인**
- 하단 상태 표시줄에서 진행률과 상태 메시지를 확인합니다.

**파일 형식 비교**:

| 형식 | 크기 | 가독성 | 용도 |
|------|------|--------|------|
| CSV (Flat) | 작음 | 높음 | Excel 분석, 데이터베이스 |
| JSON (Flat) | 중간 | 중간 | 프로그래밍, API 연동 |
| JSON (Tree) | 큼 | 낮음 | 계층 구조 분석, 재귀 처리 |

**💡 팁**:
- CSV는 Excel에서 바로 열 수 있습니다.
- JSON (Tree)는 계층 구조를 유지하므로 시각화 도구에 적합합니다.

---

### 기능 4: 검색 세트 자동 생성

#### 목적
선택한 속성 조건으로 Navisworks 검색 세트를 자동으로 생성합니다.

#### 사용 방법

**1. 속성 선택**
- 오른쪽 속성 패널에서 검색 조건으로 사용할 속성의 **체크박스**를 선택합니다.
- 여러 속성을 선택할 수 있습니다.

**2. 폴더명 입력 (선택)**
- 하단 `폴더명` 텍스트 박스에 검색 세트를 그룹화할 폴더 이름을 입력합니다.
- 예: "벽체", "구조부재", "기계설비"
- 비워두면 루트에 생성됩니다.

**3. 검색 세트 생성**
- **버튼**: `검색 세트 생성`
- 선택한 속성들이 Navisworks 검색 세트로 자동 생성됩니다.

**4. 결과 확인**
- Navisworks 왼쪽 **Selection Tree** 패널에서 생성된 검색 세트를 확인합니다.
- 폴더 구조:
  ```
  Search Sets/
  └── [폴더명]/
      ├── [속성1 = 값1]
      ├── [속성2 = 값2]
      └── ...
  ```

**💡 팁**:
- 검색 세트는 Navisworks 세션에 저장되므로 프로젝트를 저장하세요.
- 동일한 이름의 검색 세트가 있으면 덮어쓰기됩니다.

---

### 기능 5: 전체 모델 내보내기

#### 목적
모델의 모든 객체 속성을 CSV 파일로 일괄 저장합니다.

#### 사용 방법

**1. 버튼 클릭**
- 왼쪽 패널 하단: `전체 모델 내보내기`

**2. 파일 저장**
- 파일 저장 대화상자에서 저장 위치와 파일명 입력

**3. 진행률 확인**
- 대용량 모델의 경우 시간이 소요됩니다.
- 하단 진행률 바에서 현재 상태를 확인하세요.

**4. 결과 파일 확인**
- CSV 파일이 생성되며, 다음 정보가 포함됩니다:
  - 객체 ID
  - 계층 경로
  - 카테고리
  - 속성명
  - 속성 값

**💡 팁**:
- 10만 개 이상의 객체가 있는 모델은 수 분이 소요될 수 있습니다.
- 내보내기 중에는 Navisworks 조작을 최소화하세요.

---

## 🛠️ 문제 해결

### 문제 1: 플러그인이 메뉴에 나타나지 않음

**원인**:
- 플러그인 파일이 올바른 위치에 없음
- Navisworks가 제대로 재시작되지 않음

**해결 방법**:
1. 플러그인 파일 위치 확인:
   ```
   C:\Program Files\Autodesk\Navisworks Manage 2025\Plugins\DXnavis\DXnavis.dll
   ```
2. Navisworks **완전 종료** 후 재실행
3. Windows 작업 관리자에서 `Roamer.exe` 프로세스가 남아있는지 확인하고 강제 종료

---

### 문제 2: 계층 구조 로드 시 오류 발생

**증상**:
- "AccessViolationException" 오류 메시지
- 로드 중 프로그램 응답 없음

**해결 방법**:
1. 모델을 완전히 로드한 후 플러그인 실행
2. 다른 플러그인과의 충돌 가능성 확인
3. Navisworks 재시작

---

### 문제 3: 속성이 표시되지 않음

**원인**:
- 선택된 객체에 속성이 없음
- 일부 객체는 API에서 속성 접근 불가

**해결 방법**:
1. 다른 객체를 선택해보기
2. Navisworks 기본 속성 패널에서 속성 확인
3. 객체가 실제로 속성을 가지고 있는지 확인

---

### 문제 4: 내보내기 시 파일이 생성되지 않음

**원인**:
- 파일 경로에 쓰기 권한 없음
- 파일명에 특수문자 사용

**해결 방법**:
1. 다른 위치에 저장 시도 (예: 바탕화면)
2. 파일명을 영문과 숫자만 사용
3. Windows 관리자 권한으로 Navisworks 실행

---

### 문제 5: 검색 세트 생성 버튼이 비활성화됨

**원인**:
- 속성이 선택되지 않음
- 체크박스를 클릭하지 않음

**해결 방법**:
1. 속성 패널에서 하나 이상의 **체크박스**를 선택
2. 체크박스가 체크된 상태인지 확인
3. 다른 속성을 선택해보기

---

## ❓ FAQ

### Q1: 이 플러그인은 무료인가요?
**A**: 네, 이 플러그인은 내부 개발 프로젝트로 무료로 제공됩니다.

### Q2: Navisworks 2024 버전에서도 사용할 수 있나요?
**A**: 아니요, 현재 Navisworks Manage 2025 전용으로 개발되었습니다. 다른 버전은 API 호환성 문제가 있을 수 있습니다.

### Q3: 대용량 모델(10만+ 객체)에서도 사용 가능한가요?
**A**: 네, 가능합니다. 다만 계층 구조 로드와 전체 모델 내보내기는 시간이 소요될 수 있습니다. 진행률 바를 참고하세요.

### Q4: CSV 파일을 Excel에서 열 수 없어요.
**A**: CSV 파일은 UTF-8 인코딩으로 저장됩니다. Excel에서 다음과 같이 열어보세요:
1. Excel 실행 → 데이터 탭 → 텍스트/CSV 가져오기
2. 인코딩: UTF-8 선택
3. 구분 기호: 쉼표 선택

### Q5: 속성 값을 편집할 수 있나요?
**A**: 현재 버전(v2)에서는 읽기 전용입니다. 속성 편집 기능은 v3에서 추가 예정입니다.

### Q6: 검색 세트가 너무 많이 생성되었어요. 삭제 방법은?
**A**: Navisworks Selection Tree 패널에서 검색 세트를 선택하고 `Delete` 키를 눌러 삭제할 수 있습니다.

### Q7: 플러그인 사용 중 Navisworks가 느려졌어요.
**A**: 대용량 모델에서 계층 구조 TreeView를 펼치면 UI 렌더링 부하가 있을 수 있습니다. 필요한 부분만 확장하거나 검색 기능을 활용하세요.

### Q8: 오류가 발생하면 어디에 보고하나요?
**A**: 개발자에게 연락하거나 GitHub 이슈를 등록해주세요. 오류 메시지와 재현 방법을 함께 제공해주시면 도움이 됩니다.

---

## 📞 지원 및 문의

### 개발자 연락처
- **개발자**: Yoon taegwan
- **이메일**: [your-email@example.com]
- **GitHub**: [repository-url]

### 추가 문서
- [개발자 가이드](DEVELOPER_GUIDE.md): 플러그인 개발 및 확장 방법
- [커밋 규칙](GIT_COMMIT_GUIDELINES.md): 기여 시 Git 규칙
- [README](../README.md): 프로젝트 개요

---

## 📚 참고 자료

- [Navisworks API 문서](https://www.autodesk.com/developer-network/platform-technologies/navisworks)
- [WPF 가이드](https://docs.microsoft.com/en-us/dotnet/desktop/wpf/)

---

**마지막 업데이트**: 2025-01-13
**문서 버전**: v1.0
**플러그인 버전**: v2.0
